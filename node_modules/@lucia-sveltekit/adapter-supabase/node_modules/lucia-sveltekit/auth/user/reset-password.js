import { hash } from "../../utils/crypto.js";
export const resetUserPasswordFunction = (context) => {
    const resetUserPassword = async (userId, password) => {
        const hashedPassword = password ? await hash(password) : null;
        await Promise.all([
            context.adapter.updateUser(userId, {
                hashed_password: hashedPassword,
            }),
            context.adapter.deleteUserRefreshTokens(userId),
        ]);
    };
    return resetUserPassword;
};
